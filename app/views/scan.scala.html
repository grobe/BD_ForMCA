
<div class="modal-body">
			      				 
				<div class="form-group">
					<input type="file" name="picture" id="picture"  class="form-control" accept="image/*;capture=camera"> 
				</div>
				   
				<div class="form-group">
					<img src="@routes.Assets.versioned("images/no-image-available.png")" crossOrigin="anonymous" width="100" height="100" id="photo" alt="photo" class="img-thumbnail">
				</div>
				<div class="form-group">
					<div id="name"></div>
				</div>
				<div class="form-group">
					<div id="bdReturnedValues"></div>
				</div>

 </div>
			      

<script>


console.log("Start");

//if (filesToUpload){
	document.getElementById("picture").addEventListener("change",handleFiles , false);	
	console.log("afteraddEventListener");
//}

document.getElementById('bdReturnedValues').innerHTML  ="";
document.getElementById('name').innerHTML  = "";


function handleFiles(evt) {
		
		        var files = evt.target.files;
		        var photo        = document.getElementById('photo');
		        var dislaySize = document.getElementById('bdReturnedValues');
				var dislayName = document.getElementById('name');
				var file = files[0];
				dislaySize.innerHTML  = "Size of the file :"+ bytesToSize(file.size)+ "- Data is transfering, please wait";
				dislayName.innerHTML  = file.name;
				var reader = new FileReader();
	            reader.onload = function(event) {
					    var dataUri = event.target.result,
				        img     = document.getElementById('photo');
					    // wait until the image has been fully processed
					    img.onload = function() {
					    	/*canvas.width = photo.width/2;
							canvas.height = photo.height/2;
					        context.drawImage(img, 0, 0, photo.width/2, photo.height/2);
					        */
					    };
					    img.src = dataUri;
					    //image.src=canvas.toDataURL();
					    
					};

				 console.log("before readAsDataURL");
				 reader.readAsDataURL(file);
				 console.log("before sendFile");
				 sendFile (file);
				 console.log("END");
		 
		}			 

		 
		
function sendFile (file){
	
	//var img = canevas.toDataURL();
	//var file = dataURItoBlob(img);
	 console.log("sendFile");
	var formData =new FormData();
	   
	  formData.append("picture", file);
	
	var request = new Request('@routes.BdController.infoBD', {
		method: 'POST',
		body: formData
		//mode: 'cors', 
		/*redirect: 'follow',
		//headers: new Headers({
		//	'Content-Type': 'text/plain'
		})*/
	});

	// Now use it!
	fetch(request).then(function(returnedValue) {
                    
		                return returnedValue.text();
		                
	                }).then(function (value){
	                	document.getElementById('bdReturnedValues').innerHTML=value;
	                	console.log("sendFile : submitForm :test ");
	                	addEventForsubmitForm("BDscan", "@routes.BdController.scannedBD");

	                	


	                	
	                });
}



</script>